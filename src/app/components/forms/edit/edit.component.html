<div class="edit-profile-container">
    <div class="edit-profile-card">
        <h2>Editar Perfil</h2>
        
        <form (ngSubmit)="guardarCambios()" #editForm="ngForm">
            <div class="profile-image-edit">
                <div class="current-image">
                    @if (userData.foto) {
                        <img [src]="userData.foto" alt="Foto de perfil actual">
                    } @else {
                        <img src="assets/images/default-profile.png" alt="Foto de perfil por defecto">
                    }
                </div>
                <div class="image-upload">
                    <label for="foto">Cambiar foto</label>
                    <input 
                        type="file" 
                        id="foto" 
                        (change)="onFileSelected($event)"
                        accept="image/*">
                </div>
            </div>

            <div class="form-group">
                <label for="rol">Rol</label>
                <input 
                    type="text" 
                    id="rol" 
                    name="rol"
                    class="form-control readonly-field" 
                    [value]="userData.rol || 'No especificado'"
                    readonly>
            </div>

            <div class="form-group">
                <label for="nombre">Nombre</label>
                <input 
                    type="text" 
                    id="nombre" 
                    name="nombre"
                    class="form-control" 
                    [(ngModel)]="userData.nombre" 
                    #nombre="ngModel"
                    required
                    minlength="2">
                @if (nombre.invalid && (nombre.dirty || nombre.touched)) {
                    <div class="alert alert-danger">
                        El nombre es obligatorio y debe tener al menos 2 caracteres
                    </div>
                }
            </div>

            <div class="form-group">
                <label for="apellidos">Apellidos</label>
                <input 
                    type="text" 
                    id="apellidos" 
                    name="apellidos"
                    class="form-control" 
                    [(ngModel)]="userData.apellidos" 
                    #apellidos="ngModel"
                    required
                    minlength="2">
                @if (apellidos.invalid && (apellidos.dirty || apellidos.touched)) {
                    <div class="alert alert-danger">
                        Los apellidos son obligatorios y deben tener al menos 2 caracteres
                    </div>
                }
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input 
                    type="email" 
                    id="email" 
                    name="email"
                    class="form-control" 
                    [(ngModel)]="userData.email" 
                    #email="ngModel"
                    required
                    pattern="[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}">
                @if (email.invalid && (email.dirty || email.touched)) {
                    <div class="alert alert-danger">
                        Introduce un correo electrónico válido
                    </div>
                }
            </div>

            <div class="form-group">
                <label for="telefono">Teléfono</label>
                <input 
                    type="tel" 
                    id="telefono" 
                    name="telefono"
                    class="form-control" 
                    [(ngModel)]="userData.telefono" 
                    #telefono="ngModel"
                    required
                    pattern="[0-9]{9}">
                @if (telefono.invalid && (telefono.dirty || telefono.touched)) {
                    <div class="alert alert-danger">
                        El teléfono debe tener 9 dígitos
                    </div>
                }
            </div>

            <div class="button-group">
                <button type="submit" class="btn btn-success" [disabled]="editForm.invalid">Guardar Cambios</button>
                <button type="button" class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
            </div>
        </form>
    </div>
</div>